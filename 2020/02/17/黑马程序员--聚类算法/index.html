<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>黑马程序员--聚类算法 | Jacky's blogs</title><meta name="description" content="黑马程序员--聚类算法"><meta name="keywords" content="聚类"><meta name="author" content="Jacky"><meta name="copyright" content="Jacky"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="canonical" href="https://wangjs-jacky.github.io/2020/02/17/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98--%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:title" content="黑马程序员--聚类算法"><meta name="twitter:description" content="黑马程序员--聚类算法"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0ef5202d-e517-4415-9333-144bc2582477.gif"><meta property="og:type" content="article"><meta property="og:title" content="黑马程序员--聚类算法"><meta property="og:url" content="https://wangjs-jacky.github.io/2020/02/17/%E9%BB%91%E9%A9%AC%E7%A8%8B%E5%BA%8F%E5%91%98--%E8%81%9A%E7%B1%BB%E7%AE%97%E6%B3%95/"><meta property="og:site_name" content="Jacky's blogs"><meta property="og:description" content="黑马程序员--聚类算法"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0ef5202d-e517-4415-9333-144bc2582477.gif"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="prev" title="Matlab官方文档--分类Demo" href="https://wangjs-jacky.github.io/2020/02/17/Matlab%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3--%E5%88%86%E7%B1%BBDemo/"><link rel="next" title="Scrcpy软件使用说明" href="https://wangjs-jacky.github.io/2020/02/03/Scrcpy%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容:${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  highlight_copy: 'true',
  highlight_lang: 'true',
  highlight_shrink: 'false',
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    title: '添加书签',
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  copyright: undefined,
  copy_copyright_js: false
  
}</script></head><body><canvas class="fireworks"></canvas><div id="header"> <div id="page-header"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Jacky's blogs</a></span><i class="fa fa-bars fa-fw toggle-menu pull-right close" aria-hidden="true"></i><span class="pull-right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/categories/SklearnAPI"><i class="fa-fw fa fa-music"></i><span> SklearnAPI</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></span><span class="pull-right" id="search_button"><a class="site-page social-icon search"><i class="fa fa-search fa-fw"></i><span> 搜索</span></a></span></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="lozad avatar_img" src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/小李.jpg" onerror="onerror=null;src='/img/friend_404.gif'"></div><div class="mobile_post_data"><div class="mobile_data_item is_center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">48</div></a></div></div><div class="mobile_data_item is_center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is_center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">54</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page" href="/categories/SklearnAPI"><i class="fa-fw fa fa-music"></i><span> SklearnAPI</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> 列表</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div><script>document.body.addEventListener('touchstart', function(){ });</script></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">目录</div><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#黑马程序员聚类"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text"> 黑马程序员–聚类</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#算法效果衡量标准"><span class="toc_mobile_items-number">1.1.</span> <span class="toc_mobile_items-text"> 算法效果衡量标准</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-sse-误差平方和"><span class="toc_mobile_items-number">1.1.1.</span> <span class="toc_mobile_items-text"> 1. SSE ：误差平方和</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#迭代效果动图对比"><span class="toc_mobile_items-number">1.1.1.1.</span> <span class="toc_mobile_items-text"> 迭代效果动图对比</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#超参数k值的确定肘部法"><span class="toc_mobile_items-number">1.1.2.</span> <span class="toc_mobile_items-text"> 超参数K值的确定–肘部法</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-轮廓系数"><span class="toc_mobile_items-number">1.1.3.</span> <span class="toc_mobile_items-text"> 2. 轮廓系数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-calinski-harabasz-indexch系数"><span class="toc_mobile_items-number">1.1.4.</span> <span class="toc_mobile_items-text"> 3. Calinski-Harabasz Index(CH系数)</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#指标解读"><span class="toc_mobile_items-number">1.1.4.1.</span> <span class="toc_mobile_items-text"> 指标解读：</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-wb系数"><span class="toc_mobile_items-number">1.1.5.</span> <span class="toc_mobile_items-text"> 4. WB系数</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#指标选择原则"><span class="toc_mobile_items-number">1.1.6.</span> <span class="toc_mobile_items-text"> 指标选择原则</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#算法优缺点分析"><span class="toc_mobile_items-number">1.1.7.</span> <span class="toc_mobile_items-text"> 算法优缺点分析</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#案例部分"><span class="toc_mobile_items-number">1.1.8.</span> <span class="toc_mobile_items-text"> 案例部分</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#算法优化"><span class="toc_mobile_items-number">1.2.</span> <span class="toc_mobile_items-text"> 算法优化</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-canopy算法配和初始聚类"><span class="toc_mobile_items-number">1.2.1.</span> <span class="toc_mobile_items-text"> 1. Canopy算法配和初始聚类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-kmeans"><span class="toc_mobile_items-number">1.2.2.</span> <span class="toc_mobile_items-text"> 2. Kmeans ++</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#3-二分k-means"><span class="toc_mobile_items-number">1.2.3.</span> <span class="toc_mobile_items-text"> 3. 二分K-means</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#4-kernel-kmeans"><span class="toc_mobile_items-number">1.2.4.</span> <span class="toc_mobile_items-text"> 4. Kernel - Kmeans</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#5-k-medoidsk-中心聚类算法"><span class="toc_mobile_items-number">1.2.5.</span> <span class="toc_mobile_items-text"> 5. K-medoids(K-中心聚类算法）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#6-isodata"><span class="toc_mobile_items-number">1.2.6.</span> <span class="toc_mobile_items-text"> 6. ISODATA</span></a></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-2"><a class="toc_mobile_items-link" href="#高阶聚类算法"><span class="toc_mobile_items-number">1.3.</span> <span class="toc_mobile_items-text"> 高阶聚类算法</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#dbscan密度聚类"><span class="toc_mobile_items-number">1.3.1.</span> <span class="toc_mobile_items-text"> DBSCAN（密度聚类）</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#层次聚类"><span class="toc_mobile_items-number">1.3.2.</span> <span class="toc_mobile_items-text"> 层次聚类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#mean-shift聚类"><span class="toc_mobile_items-number">1.3.3.</span> <span class="toc_mobile_items-text"> Mean Shift聚类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#ap聚类"><span class="toc_mobile_items-number">1.3.4.</span> <span class="toc_mobile_items-text"> AP聚类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#som聚类"><span class="toc_mobile_items-number">1.3.5.</span> <span class="toc_mobile_items-text"> SOM聚类</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#谱聚类"><span class="toc_mobile_items-number">1.3.6.</span> <span class="toc_mobile_items-text"> 谱聚类</span></a></li></ol></li></ol></li><li class="toc_mobile_items-item toc_mobile_items-level-1"><a class="toc_mobile_items-link" href="#案例部分-2"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text"> 案例部分</span></a></li></ol></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#黑马程序员聚类"><span class="toc-number">1.</span> <span class="toc-text"> 黑马程序员–聚类</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#算法效果衡量标准"><span class="toc-number">1.1.</span> <span class="toc-text"> 算法效果衡量标准</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-sse-误差平方和"><span class="toc-number">1.1.1.</span> <span class="toc-text"> 1. SSE ：误差平方和</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#迭代效果动图对比"><span class="toc-number">1.1.1.1.</span> <span class="toc-text"> 迭代效果动图对比</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#超参数k值的确定肘部法"><span class="toc-number">1.1.2.</span> <span class="toc-text"> 超参数K值的确定–肘部法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-轮廓系数"><span class="toc-number">1.1.3.</span> <span class="toc-text"> 2. 轮廓系数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-calinski-harabasz-indexch系数"><span class="toc-number">1.1.4.</span> <span class="toc-text"> 3. Calinski-Harabasz Index(CH系数)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#指标解读"><span class="toc-number">1.1.4.1.</span> <span class="toc-text"> 指标解读：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-wb系数"><span class="toc-number">1.1.5.</span> <span class="toc-text"> 4. WB系数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#指标选择原则"><span class="toc-number">1.1.6.</span> <span class="toc-text"> 指标选择原则</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#算法优缺点分析"><span class="toc-number">1.1.7.</span> <span class="toc-text"> 算法优缺点分析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#案例部分"><span class="toc-number">1.1.8.</span> <span class="toc-text"> 案例部分</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#算法优化"><span class="toc-number">1.2.</span> <span class="toc-text"> 算法优化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-canopy算法配和初始聚类"><span class="toc-number">1.2.1.</span> <span class="toc-text"> 1. Canopy算法配和初始聚类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-kmeans"><span class="toc-number">1.2.2.</span> <span class="toc-text"> 2. Kmeans ++</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-二分k-means"><span class="toc-number">1.2.3.</span> <span class="toc-text"> 3. 二分K-means</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-kernel-kmeans"><span class="toc-number">1.2.4.</span> <span class="toc-text"> 4. Kernel - Kmeans</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-k-medoidsk-中心聚类算法"><span class="toc-number">1.2.5.</span> <span class="toc-text"> 5. K-medoids(K-中心聚类算法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-isodata"><span class="toc-number">1.2.6.</span> <span class="toc-text"> 6. ISODATA</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#高阶聚类算法"><span class="toc-number">1.3.</span> <span class="toc-text"> 高阶聚类算法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dbscan密度聚类"><span class="toc-number">1.3.1.</span> <span class="toc-text"> DBSCAN（密度聚类）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#层次聚类"><span class="toc-number">1.3.2.</span> <span class="toc-text"> 层次聚类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mean-shift聚类"><span class="toc-number">1.3.3.</span> <span class="toc-text"> Mean Shift聚类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ap聚类"><span class="toc-number">1.3.4.</span> <span class="toc-text"> AP聚类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#som聚类"><span class="toc-number">1.3.5.</span> <span class="toc-text"> SOM聚类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#谱聚类"><span class="toc-number">1.3.6.</span> <span class="toc-text"> 谱聚类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#案例部分-2"><span class="toc-number">2.</span> <span class="toc-text"> 案例部分</span></a></li></ol></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0ef5202d-e517-4415-9333-144bc2582477.gif)"><div id="post-info"><div id="post-title"><div class="posttitle">黑马程序员--聚类算法</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 发表于 2020-02-17<span class="post-meta__separator">|</span><i class="fa fa-history" aria-hidden="true"></i> 更新于 2020-02-17</time><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">4.2k</span><span class="post-meta__separator">|</span><span>阅读时长: 14 分钟</span><span class="post-meta__separator">|</span><span>阅读量: </span><span id="busuanzi_value_page_pv"></span></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h1 id="黑马程序员聚类"><a class="markdownIt-Anchor" href="#黑马程序员聚类"></a> 黑马程序员–聚类</h1>
<p>通过对无标记训练样本的学习找到数据的内在性质与规律。</p>
<h2 id="算法效果衡量标准"><a class="markdownIt-Anchor" href="#算法效果衡量标准"></a> 算法效果衡量标准</h2>
<h3 id="1-sse-误差平方和"><a class="markdownIt-Anchor" href="#1-sse-误差平方和"></a> 1. SSE ：误差平方和</h3>
<img style="zoom: 67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210204216.png" class="lozad">
<blockquote>
<p>先求一个圈内的对于中心点的平方和，再将所有圈的平方和加起来就是SSE指标</p>
</blockquote>
<h4 id="迭代效果动图对比"><a class="markdownIt-Anchor" href="#迭代效果动图对比"></a> 迭代效果动图对比</h4>
<p>横轴是迭代的次数，纵轴是<strong>SSE指标</strong>，SSE指标总体上反映的是聚类的离散程度。下面反映的是对**初始中心(质心)**的影响。</p>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/111.gif" class="lozad">
<img style="zoom: 80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/8e6be715-3267-4520-a5b6-b0e4312f0802.gif" class="lozad">
<h3 id="超参数k值的确定肘部法"><a class="markdownIt-Anchor" href="#超参数k值的确定肘部法"></a> 超参数K值的确定–肘部法</h3>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210205721.png" class="lozad"></p>
<h3 id="2-轮廓系数"><a class="markdownIt-Anchor" href="#2-轮廓系数"></a> 2. 轮廓系数</h3>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo>−</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><mrow><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">{</mo><mi>a</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo><mo stretchy="false">}</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">S(i)= \frac{b(i)-a(i)}{max\{a(i),b(i)\}}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mord mathdefault">a</span><span class="mord mathdefault">x</span><span class="mopen">{</span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mclose">}</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault">a</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>b</mi><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">b(i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">b</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span> 指的是某点到其他聚类的<strong>最小的</strong>距离平均值</p>
</li>
<li>
<p>$a(i) $指的是某点到自己类内的距离平均值</p>
</li>
<li>
<p>S(i) 的范围为[-1,1]</p>
</li>
<li>
<p>每次聚类后，每个样本都会得到一个轮廓系数，当它为1时，说明这个点与周围簇距离较远，结果非常好；当它为0，说明这个点可能处在两个簇的边界上，当值为负时，暗含该点可能被误分了。</p>
</li>
</ul>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210205927.png" class="lozad">
<p>对于以下应该聚2类好，还是4类好？</p>
<img style="zoom: 80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210210731.png" class="lozad">
<table>
<thead>
<tr>
<th style="text-align:center">2类，样本数不均衡（轮廓系数=0.70）</th>
<th style="text-align:center">4类样本数均衡（轮廓系数=0.65）</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210210828.png" class="lozad"></td>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210210845.png" class="lozad"></td>
</tr>
</tbody>
</table>
<blockquote>
<p>轮廓系数并非越高越好，还需要考虑样本的均衡做出选择。</p>
</blockquote>
<h3 id="3-calinski-harabasz-indexch系数"><a class="markdownIt-Anchor" href="#3-calinski-harabasz-indexch系数"></a> 3. Calinski-Harabasz Index(CH系数)</h3>
<blockquote>
<p>核心： 用尽量少的类别聚出更多的样本。所以指标中有与样本数量有关的指标m</p>
</blockquote>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>H</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow><mrow><mi>S</mi><mi>S</mi><mi>W</mi></mrow></mfrac><mfrac><mrow><mi>m</mi><mo>−</mo><mi>k</mi></mrow><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">CH(k)=\frac{SSB}{SSW}\frac{m-k}{k-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord mathdefault" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.14077em;vertical-align:-0.7693300000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">1</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693300000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><mi>W</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><mi mathvariant="normal">∥</mi><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>C</mi><mrow><mi>p</mi><mi>i</mi></mrow></msub><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">SSW = \sum_{i=1}^m\|x_i-C_{pi}\|^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">∥</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.150216em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mi>S</mi><mi>B</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>n</mi><mi>j</mi></msub><mi mathvariant="normal">∥</mi><msub><mi>C</mi><mi>j</mi></msub><mo>−</mo><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><msup><mi mathvariant="normal">∥</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">SSB = \sum_{i=1}^k n_j\|C_j-\bar{X}\|^2
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1137820000000005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8361130000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">∥</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201099999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07847em;">X</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">ˉ</span></span></span></span></span></span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p>这里解释以下为啥SSB前面会乘上一个系数，因为SSB计算的是类间权重，因为不同的类的样本个数不一样，如下图，先计算每类中心与总体均值（在下图的空白处）的差值的平方，再按照权重累加所有的差值。</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200210211059.png" class="lozad"></p>
<h4 id="指标解读"><a class="markdownIt-Anchor" href="#指标解读"></a> 指标解读：</h4>
<ul>
<li>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>−</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">m-k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span></span></span></span> 的含义是：反映的是降维的强度，如从100个样本聚3类就比从4个样本聚3类的效果强。</p>
</li>
<li>
<p>除以 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 的含义是：k值越到，说明聚的越细，如100个样本聚99类则失去意义。</p>
</li>
</ul>
<h3 id="4-wb系数"><a class="markdownIt-Anchor" href="#4-wb系数"></a> 4. WB系数</h3>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>W</mi><mi>B</mi><mo>=</mo><mi>k</mi><mo>×</mo><mfrac><mrow><mi>S</mi><mi>S</mi><mi>W</mi></mrow><mrow><mi>S</mi><mi>S</mi><mi>B</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">WB = k \times \frac{SSW}{SSB}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:2.04633em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.36033em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05017em;">B</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mord mathdefault" style="margin-right:0.13889em;">W</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<blockquote>
<p>原理同上，只不过现在是类内方差是分子，故结果是越小说明聚类效果越好。</p>
</blockquote>
<h3 id="指标选择原则"><a class="markdownIt-Anchor" href="#指标选择原则"></a> 指标选择原则</h3>
<ul>
<li>以上介绍的几个评价聚类的指标，并非是单调递增或者递减的，所以一定要结合多个参数交叉选择<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>参数</li>
</ul>
<img style="zoom: 67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200211003220.png" class="lozad">
<h3 id="算法优缺点分析"><a class="markdownIt-Anchor" href="#算法优缺点分析"></a> 算法优缺点分析</h3>
<ul>
<li>
<p>优点：</p>
<ul>
<li>原理简单易懂</li>
<li>聚类效果中上</li>
<li>空间复杂度o(N)，时间复杂度o(I*K*N)</li>
</ul>
</li>
<li>
<p>缺点</p>
<ul>
<li>对离群点，如噪声敏感</li>
<li>易遗漏大小相差很大的类别（即大类别吞噬小类别）</li>
<li>并非全局最优</li>
</ul>
</li>
</ul>
<h3 id="案例部分"><a class="markdownIt-Anchor" href="#案例部分"></a> 案例部分</h3>
<ol>
<li><a href="https://www.bilibili.com/video/av44274148?p=13" target="_blank" rel="noopener">工业车辆聚类</a></li>
<li><a href="https://www.bilibili.com/video/av44274148?p=23" target="_blank" rel="noopener">图片压缩实战</a></li>
</ol>
<h2 id="算法优化"><a class="markdownIt-Anchor" href="#算法优化"></a> 算法优化</h2>
<h3 id="1-canopy算法配和初始聚类"><a class="markdownIt-Anchor" href="#1-canopy算法配和初始聚类"></a> 1. Canopy算法配和初始聚类</h3>
<p>步骤：</p>
<ol>
<li>
<p>随机选择一个点，绘制两个圆，半径分别是T1和T2</p>
</li>
<li>
<p>划分T1半径内的为同一类，T1和T2间的圆环内的为待定黑点，说明可能是同一类，也可能不是同一类。而对于T2外的点则判断肯定不是同类点。</p>
</li>
<li>
<p>对于T2外的原点重复1,2步骤。</p>
<p>(过程中可能将原先未确定的黑点做出判断)</p>
</li>
</ol>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212162459.png" class="lozad">
<p>优缺点分析：</p>
<ol>
<li>
<p>Kmeans 对噪声敏感，通过Canopy可规定聚类中心的点，在T1半径内必须满足一定的点数，对于不满足点数的聚类中心直接去除，有利于解决噪声的干扰问题。</p>
</li>
<li>
<p>Canopy选择出来的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>值会更加精准。</p>
</li>
<li>
<p>只是对每个Canopy的内部进行Kmeans聚类，而非对整体做Kmeans聚类，计算量减少</p>
</li>
</ol>
<p>缺点：</p>
<ol>
<li>超参数需要手动确定 T1和T2</li>
</ol>
<h3 id="2-kmeans"><a class="markdownIt-Anchor" href="#2-kmeans"></a> 2. Kmeans ++</h3>
<p>原理：做质心选择的时候，尽可能的远。</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212163802.png" class="lozad"></p>
<p>质心的选择通过概率控制：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>=</mo><mfrac><mrow><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow><mrow><munder><mo>∑</mo><mrow><mi>x</mi><mo>∈</mo><mi>X</mi></mrow></munder><mi>D</mi><mo stretchy="false">(</mo><mi>x</mi><msup><mo stretchy="false">)</mo><mn>2</mn></msup></mrow></mfrac></mrow><annotation encoding="application/x-tex">P = \frac{D(x)^2}{\sum_{x\in X}D(x)^2}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.504188em;vertical-align:-1.01308em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.491108em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.17862099999999992em;"><span style="top:-2.40029em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">x</span><span class="mrel mtight">∈</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">X</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.32708000000000004em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">D</span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.01308em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中：</p>
<ul>
<li>
<p>分子部分是：待选择的质心到上一个质心的距离</p>
</li>
<li>
<p>分母部分是：所有点到上一个质心的距离</p>
</li>
</ul>
<h3 id="3-二分k-means"><a class="markdownIt-Anchor" href="#3-二分k-means"></a> 3. 二分K-means</h3>
<p>算法步骤：</p>
<ol>
<li>所有点作为一个簇</li>
<li>将簇一分为二</li>
<li>选择<strong>最大限度降低</strong>降低SSE（误差平方和）的簇去划分两个簇</li>
<li>重复2,3两步，知道簇的数目等于用户给定的数目</li>
</ol>
<img style="zoom:67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212164736.png" class="lozad">
<p>优缺点分析：</p>
<ol>
<li>可以加速Kmeans的执行速度</li>
<li>过程中不存在随机性，结果唯一</li>
</ol>
<h3 id="4-kernel-kmeans"><a class="markdownIt-Anchor" href="#4-kernel-kmeans"></a> 4. Kernel - Kmeans</h3>
<blockquote>
<p>解决：线性不可分的问题。主要利用了核方法的技巧，把低维数据映射到高维空间再利用Kmeans做一次聚类。</p>
</blockquote>
<p>如区分下图中红色和黑色块的部分：</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212165201.png" class="lozad"></p>
<p>算法比对：</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212165333.png" class="lozad"></p>
<p>优缺点分析：</p>
<ol>
<li>适合线性不可分的场景</li>
<li>计算复杂度高</li>
</ol>
<h3 id="5-k-medoidsk-中心聚类算法"><a class="markdownIt-Anchor" href="#5-k-medoidsk-中心聚类算法"></a> 5. K-medoids(K-中心聚类算法）</h3>
<blockquote>
<p>解决：K-means对异常值的敏感</p>
</blockquote>
<p>K-medoids和K-means是有区别的，<strong>不一样的地方在于中心点的选取</strong>：</p>
<ul>
<li>
<p>K-means中，将中心点取为<strong>当前簇中所有数据点的平均值</strong>，对异常点很敏感！【虚拟计算点】</p>
</li>
<li>
<p>K-medoids中，将从<strong>当前簇中选取到其他所有本簇内点的距离之和最小</strong>的点作为中心点。【实际样本点】</p>
<p>注：这里的距离用的是<strong>曼哈顿距离</strong>。</p>
</li>
</ul>
<p><strong>算法部步骤：</strong></p>
<ol>
<li>随机选择K个点作为medoids</li>
<li>聚类：将剩余的n-k个点分配到最佳的medoids</li>
<li>根据曼哈顿距离重新计算中心</li>
<li>迭代更新中心点，直至最大迭代数</li>
</ol>
<p>优缺点：</p>
<ol>
<li>噪声<strong>鲁棒性好</strong></li>
<li>计算量大，建议<strong>小样本</strong></li>
<li>虽然说初始中心都是随机选择的，但是随机性相对于Kmeans小很多，基本上每次运行程序得到的结果差不多。注：但是与Kmeans都是<strong>局部最优解</strong>。</li>
</ol>
<h3 id="6-isodata"><a class="markdownIt-Anchor" href="#6-isodata"></a> 6. ISODATA</h3>
<blockquote>
<p>全称：Iterative Self Organizing Data Analysis Techniques Algorithm</p>
<p>特点：自适应确定<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>K</mi></mrow><annotation encoding="application/x-tex">K</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span></span></span></span>的个数，最终聚类中心的个数在一个范围内: <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mi>K</mi><mi mathvariant="normal">/</mi><mn>2</mn><mo separator="true">,</mo><mn>2</mn><mi>K</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[K/2,2K]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mord">/</span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mord mathdefault" style="margin-right:0.07153em;">K</span><span class="mclose">]</span></span></span></span></p>
</blockquote>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/b4383590-6de8-4842-a42b-aa9d23729b6a.gif" class="lozad">
<p><strong>核心原理：</strong></p>
<ol>
<li>合并：当某一个类的<strong>样本个数太少</strong>，或者两个类的<strong>距离太近</strong>可视为一类</li>
<li>分裂：当某一个类的<strong>类内方差太大</strong>，则将该类进行分裂</li>
</ol>
<p>可选参数：</p>
<p>​	因ISODATA多用于遥感卫星图像的处理，所以输入的参数与Pixels有关。</p>
<img style="zoom: 67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212171338.png" class="lozad">
<h2 id="高阶聚类算法"><a class="markdownIt-Anchor" href="#高阶聚类算法"></a> 高阶聚类算法</h2>
<h3 id="dbscan密度聚类"><a class="markdownIt-Anchor" href="#dbscan密度聚类"></a> DBSCAN（密度聚类）</h3>
<table>
<thead>
<tr>
<th style="text-align:center">Kmeans聚类失败的案例：</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212171717.png" class="lozad"></td>
</tr>
<tr>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212171829.png" class="lozad"></td>
</tr>
<tr>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212171846.png" class="lozad"></td>
</tr>
</tbody>
</table>
<p><strong>聚类过程演示：</strong></p>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0ef5202d-e517-4415-9333-144bc2582477.gif" class="lozad">
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/b311ccc5-7b20-4b7b-9640-026ebbf10cca.gif" class="lozad"></p>
<p><strong>专业名词：</strong></p>
<img style="zoom: 80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212172456.png" class="lozad">
<ul>
<li>
<p>点的名称</p>
<ul>
<li>核心点（需要满足一定的点）</li>
<li>边界点</li>
<li>噪声点</li>
</ul>
</li>
<li>
<p>过程名称</p>
<ul>
<li>密度可达</li>
<li>密度相连</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">算法缺点：领域的不同可能创造更多的噪声点：</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212181042.png" class="lozad"></td>
</tr>
</tbody>
</table>
<p><strong>优缺点分析：</strong></p>
<table>
<thead>
<tr>
<th>优点</th>
<th>缺点</th>
</tr>
</thead>
<tbody>
<tr>
<td>1. 聚类速度快，且能有效处理噪声，可以对任意形状的聚类</td>
<td>1. 数据量增大的时候，需要较大内存才能完成操作</td>
</tr>
<tr>
<td>2. 自适应聚类个数</td>
<td>2. 当不同类别密度差距大，超参数领域的大小和点数的设定比较困难</td>
</tr>
<tr>
<td></td>
<td>3. 对于高维数据存在“维度灾难”</td>
</tr>
</tbody>
</table>
<h3 id="层次聚类"><a class="markdownIt-Anchor" href="#层次聚类"></a> 层次聚类</h3>
<img style="zoom:67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212182647.png" class="lozad">
<p><strong>聚类的步骤：</strong></p>
<ol>
<li>
<p>计算距离表格</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212182837.png" class="lozad"></p>
</li>
<li>
<p>找到上面表格中聚类最近的两类，合并，再重复1的步骤</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212182939.png" class="lozad"></p>
</li>
</ol>
<blockquote>
<p>如何度量两个类之间的距离？</p>
<ul>
<li>
<p>MIn度量</p>
</li>
<li>
<p>MAX度量</p>
</li>
<li>
<p>平均距离度量</p>
<img style="zoom: 67%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212181757.png" class="lozad">
</li>
<li>
<p>质心度量</p>
</li>
</ul>
</blockquote>
<ol start="3">
<li>
<p>合并的时候需要记录两个类之间的距离：</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212182231.png" class="lozad"></p>
<blockquote>
<p>红线计算的是合并前两个类别的距离，把计算的值作为聚类图的竖线。</p>
</blockquote>
</li>
</ol>
<p><strong>优缺点：</strong></p>
<ul>
<li>
<p>优点</p>
<ol>
<li>不需要预先指定聚类数</li>
<li>可以发现类的层次关系</li>
</ol>
</li>
<li>
<p>缺点：</p>
<ol>
<li>计算复杂度高</li>
<li>易产生链状聚类</li>
</ol>
</li>
</ul>
<h3 id="mean-shift聚类"><a class="markdownIt-Anchor" href="#mean-shift聚类"></a> Mean Shift聚类</h3>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/a13e02c8-59e6-415b-bdc6-75abcb3e83c5.gif" class="lozad"></p>
<blockquote>
<p>多用于动态捕捉</p>
</blockquote>
<p><strong>算法步骤：</strong></p>
<ol>
<li>
<p>设置一堆标记点**(非样本点)**，随机选择一个作为中心开始</p>
</li>
<li>
<p>计算半径为<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">r</span></span></span></span> 的圆内的<strong>向量的合方向</strong>作为移动方向</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212183231.png" class="lozad"></p>
</li>
<li>
<p>移动中心，重新就算<strong>向量的合方向</strong></p>
</li>
<li>
<p>移动终止条件：shift的距离小于阈值停止，记录聚类中心center，以及移动路径中所有的点都归为此类</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/9beff3a2-824d-4757-ae8c-0befbba0b577.gif" class="lozad"></p>
</li>
<li>
<p>复核：重复上述1,2,3,4步骤，如果此时的center小于阈值则视为一类，若大于阈值则为不同类。直至所有的标记点被访问过一遍。</p>
</li>
<li>
<p>归类：因为不同的标记的点可能多次途径样本点，取访问频率最大的类作为当前样本点的类别。</p>
</li>
</ol>
<p><strong>注意事项：</strong></p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212185717.png" class="lozad"></p>
<h3 id="ap聚类"><a class="markdownIt-Anchor" href="#ap聚类"></a> AP聚类</h3>
<p><strong>Preference参考度或者偏好参数：<strong>是相似度矩阵中横轴纵轴索引相同的点，如<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>S</mi><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>i</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">S(i,i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="mopen">(</span><span class="mord mathdefault">i</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">i</span><span class="mclose">)</span></span></span></span>，若按欧氏距离计算其值应为0，但在AP聚类中其表示</strong>数据点<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.65952em;vertical-align:0em;"></span><span class="mord mathdefault">i</span></span></span></span>作为聚类中心的程度</strong>，因此不能为0。<strong>迭代开始前假设所有点成为聚类中心的能力相同</strong>，因此参考度一般设为相似度矩阵中所有值的<strong>最小值或者中位数</strong>，<strong>参考度越大则说明这个数据点成为聚类中心的能力越强，最终聚类中心的个数很可能也越多</strong>。</p>
<p><strong>AP算法需要注意的点：</strong></p>
<ol>
<li>聚类结果需要进一步分析</li>
</ol>
<table>
<thead>
<tr>
<th>不同的中心可为同一类</th>
<th>结构如：类树叉</th>
</tr>
</thead>
<tbody>
<tr>
<td><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212190551.png" class="lozad"></td>
<td><img alt="image-20200212190630972" data-src="C:%5CUsers%5Cwangj%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5Cimage-20200212190630972.png" class="lozad"></td>
</tr>
</tbody>
</table>
<ol start="2">
<li>不一定收敛</li>
</ol>
<p>优缺点：</p>
<ol>
<li>不需要设置聚类的个数，由Preference决定</li>
<li>由已有的点作为聚类的中心</li>
</ol>
<p>缺点：</p>
<ol>
<li>需要计算所有点的相似度，需要大内存</li>
<li>复杂度高 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>o</mi><mo stretchy="false">(</mo><msup><mi>N</mi><mn>3</mn></msup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">o(N^3)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="mord mathdefault">o</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></li>
<li>受Preference和阻尼系数影响大</li>
</ol>
<h3 id="som聚类"><a class="markdownIt-Anchor" href="#som聚类"></a> SOM聚类</h3>
<p>基本原理：模拟人脑处于不同区域的神经细胞分工不同，即不同区域具有不同的相应特征。</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212191245.png" class="lozad"></p>
<p>SOM神经网络的全称是Self Organizing Maps (SOM)自组织映射。其学习路径是先由对抗（竞争）网络的基础上发展出来的。但是SOM多了一个东西就是其映射保留了输入特征的拓扑特性。什么意思呢？加入说原先有个向量是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>D</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X = \{x_1,x_2,\dots,x_D\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>这里是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">D</span></span></span></span>是指维度。理论上机器学习中默认所有的变量是独立的，或者说是无序的。即<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>D</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X = \{x_1,x_2,\dots,x_D\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>X</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mi>D</mi></msub><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><msub><mi>x</mi><mn>2</mn></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">X = \{x_D,\dots,x_2,x_1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>训练出的结果是一样的。但是若是考虑了input向量的拓扑结果，则可能最终的分类结果是完全不同的。</p>
<p>SOM为了保留输入向量的拓扑结构，构造了一个竞争层，一般为二维网格平面(也称Kohonen Network，因为SOM的提出者是芬兰神经网络专家Kohonen教授)，网格点即为神经元，点与点之间保持一定的结构关系（即拓扑）。这里的竞争层就是原先的输出层，只不过这里用SOM做聚类任务，无需输出。(传统神经网络输出值的主要目的是为了做回归任务)。总结SOM就是一个单输出，单输出无隐藏层的神经网络结构。</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200214151633.png" class="lozad"></p>
<p><strong>具体步骤如下：</strong></p>
<ol>
<li>
<p>初始化：每个节点开始初始化所有自己的参数<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>j</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow></msub></mrow><annotation encoding="application/x-tex">w_{j(\cdot)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7857599999999999em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mopen mtight">(</span><span class="mord mtight">⋅</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span></span></span></span></p>
</li>
<li>
<p>竞争：对于每一个输入数据，找到与它最相配的节点。假设输入时D维的， 即 X={x_i, i=1,…,D}，那么判别函数可以为欧几里得距离：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>d</mi><mi>j</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>D</mi></munderover><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msubsup><mi>w</mi><mrow><mi>i</mi><mi>j</mi></mrow><mn>2</mn></msubsup><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">d_j(x)=\sum_{i=1}^D(x_i-w_{ij}^2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.106005em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.2472159999999999em;vertical-align:-0.383108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.864108em;"><span style="top:-2.4530000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.383108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<blockquote>
<p>因为权重是随便设置的，所以一开始样本<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">x^{(i)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8879999999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8879999999999999em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>可能随机匹配到上述网格中其中某一个神经元结点。那下一步我就强化这一点与第一个样本向量之间的关系，那么下一次再来一个与此样本相似的向量时，会优先选择此前激活过的神经元范围内的结点。</p>
<p>还有就是一开始邻域的范围很大，可能占到半个数据集，后面慢慢缩小。</p>
<p>具体做法：就是让权重更靠近。</p>
</blockquote>
</li>
<li>
<p>每一次迭代，一个样本只能与一个神经元有关系，赢者通吃。获胜单元及其邻域内的神经元开始向这个输入向量靠近。更新权重有一个原则，激活节点神经元与输入向量权重更近，周围的邻域内的神经元根据距离的远近更新权重。</p>
<p>首先定义邻域：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo stretchy="false">(</mo><mo>−</mo><mfrac><msubsup><mi>S</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></msubsup><mrow><mn>2</mn><msup><mi>σ</mi><mn>2</mn></msup></mrow></mfrac><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">T_{j,I(x)}=exp(-\frac{S^2_{j,I(x)}}{2\sigma^2})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.03853em;vertical-align:-0.3551999999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.3871079999999996em;vertical-align:-0.686em;"></span><span class="mord mathdefault">e</span><span class="mord mathdefault">x</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">−</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7011079999999996em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.740108em;"><span style="top:-2.9890000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.887em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141079999999998em;"><span style="top:-2.378em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.49699999999999994em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mclose">)</span></span></span></span></span></p>
<p>可以发现T的取值范围是<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><mn>1</mn><mo separator="true">,</mo><mn>0</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[1,0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">0</span><span class="mclose">)</span></span></span></span> ,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>S</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">S_{ij}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.05764em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>表示节点i和j之间的距离。可以发现距离越远，T的值越小。接下来更新节点的权重参数了，现在<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">x_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>与<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{ji}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.716668em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>还差<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(x_i-w_{ji})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>就完全相等了，当然不能一次性全部更新完，所以需要设置一个学习率<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>η</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\eta(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span>。T的目的则是再加上一个系数减少更新程度。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo>=</mo><mi>η</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><msub><mi>T</mi><mrow><mi>j</mi><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo>−</mo><msub><mi>w</mi><mrow><mi>j</mi><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\Delta w_{ji}=\eta(t)T_{j,I(x)}(t)(x_i-w_{ji})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1052em;vertical-align:-0.3551999999999999em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">η</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.07847em;">I</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mopen">(</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.02691em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mord mathdefault mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
</li>
<li>
<p>提供新样本，重复上面的操作</p>
</li>
<li>
<p>随着epoch的进行，需要不断的收缩邻域的半径，减少学习率，重复，知道小于允许值，输出聚类结果。</p>
</li>
</ol>
<p>文献下载地址：<a href="http://www.cs.bham.ac.uk/~jxb/NN/l16.pdf" target="_blank" rel="noopener">http://www.cs.bham.ac.uk/~jxb/NN/l16.pdf</a></p>
<p><strong>SOM聚类的步骤：</strong></p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0722027c-bc23-4981-88dd-260447945ad4.gif" class="lozad"></p>
<p><strong>SOM的训练过程：</strong><br>
紫色区域表示训练数据的分布状况，白色网格表示从该分布中提取的当前训练数据。<br>
（1）SOM节点位于数据空间的任意位置，最接近训练数据的节点（黄色高亮部分）会被选中。它和网格中的邻近节点一样，朝训练数据移动。<br>
（2）在多次迭代之后，网格倾向于近似该种数据分布（下图最右）。</p>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212192939.png" class="lozad"></p>
<p>所有神经元组织成一个网络，网格可以是六边形，四边形，甚至是链形。网格的结构通常取决于输入的数据在空间中的分布。SOM的作用是将网格铺满数据存在的空间。</p>
<img style="zoom:80%;" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/7b2826a5-6a4d-4160-aecd-e13fc1a3d201.gif" class="lozad">
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200212193401.png" class="lozad"></p>
<p>特点：</p>
<ol>
<li>SOM无需提前设置聚类的数目。</li>
<li>SOM受极端值的影响要小于K-means。</li>
</ol>
<p>下面是一个Maltab实践SOM神经网络的小的Demo代码</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%% I. 清空环境变量</span></span><br><span class="line">clear all</span><br><span class="line">clc</span><br><span class="line"><span class="comment">%% II. 训练集/测试集产生</span></span><br><span class="line"><span class="comment">%%</span></span><br><span class="line"><span class="comment">% 1. 导入数据</span></span><br><span class="line"><span class="comment">% load water_data.mat</span></span><br><span class="line">mu = [<span class="number">0</span>,<span class="number">2</span> ; <span class="number">5</span>,<span class="number">6</span> ; <span class="number">9</span>,<span class="number">10</span>];<span class="comment">%数学期望</span></span><br><span class="line">sigma = [<span class="number">1</span>,<span class="number">0</span>;<span class="number">0</span>,<span class="number">4</span>];<span class="comment">%协方差矩阵</span></span><br><span class="line">r1 = mvnrnd(mu(<span class="number">1</span>,:),sigma,<span class="number">100</span>);<span class="comment">%生成50个样本</span></span><br><span class="line">r2 = mvnrnd(mu(<span class="number">2</span>,:),sigma,<span class="number">100</span>);<span class="comment">%生成50个样本</span></span><br><span class="line">r3 = mvnrnd(mu(<span class="number">3</span>,:),sigma,<span class="number">100</span>);<span class="comment">%生成50个样本</span></span><br><span class="line">P_train = [r1;r2;r3]';</span><br><span class="line"></span><br><span class="line"><span class="comment">%% IV. SOFM神经网络创建、训练及仿真测试</span></span><br><span class="line"><span class="comment">% 1. 创建网络</span></span><br><span class="line">net = newsom(P_train,[<span class="number">3</span> <span class="number">1</span>]);</span><br><span class="line"><span class="comment">% 2. 设置训练参数</span></span><br><span class="line">net.trainParam.epochs = <span class="number">200</span>;</span><br><span class="line"><span class="comment">% 3. 训练网络</span></span><br><span class="line">net = train(net,P_train);</span><br><span class="line"><span class="comment">% 4. 仿真测试</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% 训练集</span></span><br><span class="line">t_sim_sofm_1 = sim(net,P_train);</span><br><span class="line">T_sim_sofm_vec2ind = vec2ind(t_sim_sofm_1);  <span class="comment">%向量和稀疏矩阵之间转换</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% 测试集</span></span><br><span class="line">t_sim_sofm_2 = sim(net,P_test);</span><br><span class="line">T_sim_sofm_vec2ind  = vec2ind(t_sim_sofm_2);</span><br></pre></td></tr></table></figure>
<p>运行完上面的程序，观察网络的神经元的位置</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="built_in">figure</span></span><br><span class="line"><span class="built_in">plot</span>(P_train(<span class="number">1</span>,:),P_train(<span class="number">2</span>,:),<span class="string">'.g'</span>,<span class="string">'markersize'</span>,<span class="number">20</span>)</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">plotsom(net.iw&#123;<span class="number">1</span>,<span class="number">1</span>&#125;,net.layers&#123;<span class="number">1</span>&#125;.distances)</span><br><span class="line"><span class="built_in">hold</span> off</span><br></pre></td></tr></table></figure>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200215212728.png" class="lozad"></p>
<p>计算某个样本和所有权重的欧氏距离，划分这个样本为距离最近的权重所代表的的神经类别。</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">distances = dist(P_train',net.IW&#123;<span class="number">1</span>&#125;');</span><br><span class="line">[d,cndx] = <span class="built_in">min</span>(distances,[],<span class="number">2</span>); <span class="comment">% cndx contains the cluster index</span></span><br><span class="line"><span class="built_in">figure</span></span><br><span class="line">gscatter(P_train(<span class="number">1</span>,:),P_train(<span class="number">2</span>,:),cndx); <span class="built_in">legend</span> off;</span><br><span class="line"><span class="built_in">hold</span> on</span><br><span class="line">plotsom(net.iw&#123;<span class="number">1</span>,<span class="number">1</span>&#125;,net.layers&#123;<span class="number">1</span>&#125;.distances);</span><br><span class="line"><span class="built_in">hold</span> off</span><br></pre></td></tr></table></figure>
<p><img alt data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200215212607.png" class="lozad"></p>
<h3 id="谱聚类"><a class="markdownIt-Anchor" href="#谱聚类"></a> 谱聚类</h3>
<blockquote>
<p>基于<strong>图论</strong>的聚类方法，通过对样本数据的<strong>拉普拉斯矩阵</strong>的特征向量进行聚类。</p>
</blockquote>
<p>视频链接：<a href="https://www.bilibili.com/video/av44274148?p=42" target="_blank" rel="noopener">B站视频</a></p>
<hr>
<h1 id="案例部分-2"><a class="markdownIt-Anchor" href="#案例部分-2"></a> 案例部分</h1>
<ol>
<li>
<p>K-means 与 DBSCAN聚类效果比较：</p>
<p><a href="https://www.bilibili.com/video/av44274148?p=44" target="_blank" rel="noopener">https://www.bilibili.com/video/av44274148?p=44</a></p>
</li>
<li>
<p>综合实践：聚类算法的客户价值分析</p>
<p><a href="https://www.bilibili.com/video/av44274148?p=47" target="_blank" rel="noopener">https://www.bilibili.com/video/av44274148?p=47</a></p>
</li>
</ol>
<p>聚类算法的其余簇评价指标：ROC、混淆矩阵</p>
</div></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%81%9A%E7%B1%BB/">聚类    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/0ef5202d-e517-4415-9333-144bc2582477.gif" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js@1.0.16/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull-left"><a href="/2020/02/17/Matlab%E5%AE%98%E6%96%B9%E6%96%87%E6%A1%A3--%E5%88%86%E7%B1%BBDemo/"><img class="prev_cover lozad" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200217134252.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">上一篇</div><div class="prev_info"><span>Matlab官方文档--分类Demo</span></div></a></div><div class="next-post pull-right"><a href="/2020/02/03/Scrcpy%E8%BD%AF%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E/"><img class="next_cover lozad" data-src="https://cdn.jsdelivr.net/gh/wangjs-jacky/testpic/img_temp/20200203184620.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">下一篇</div><div class="next_info"><span>Scrcpy软件使用说明</span></div></a></div></nav></div></div><footer><div id="footer"><div class="copyright">&copy;2019 - 2020 By Jacky</div><div class="framework-info"><span>驱动 </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div><div class="footer_custom_text">Hi, welcome to my <a href="http://wangjs-jacky.github.io">blog</a>!</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="阅读模式"></i><i class="fa fa-plus" id="font_plus" title="放大字体"></i><i class="fa fa-minus" id="font_minus" title="缩小字体"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="简繁转换">繁</a><i class="nightshift fa fa-moon-o" id="nightshift" title="夜间模式"></i></div><div id="rightside-config-show"><div id="rightside_config" title="设置"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="目录" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="回到顶部" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script async src="/js/search/local-search.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script><script src="/js/nightshift.js"></script><script color="0,0,255" opacity="0.7" zIndex="-1" count="99" src="https://cdn.jsdelivr.net/gh/jerryc127/CDN/js/canvas-nest.js"></script><script src="/js/tw_cn.js"></script><script>translateInitilization()

</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@1.2.2/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script><script>const observer = lozad(); // lazy loads elements with default selector as '.lozad'
observer.observe();
</script><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a href="https://github.com/wzpan/hexo-generator-search" target="_blank" rel="noopener" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fa fa-times"></i></span></div><div class="search-mask"></div></body></html>